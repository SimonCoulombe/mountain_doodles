<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jens von Bergmann">
<meta name="dcterms.date" content="2018-07-17">
<meta name="description" content="How is low-density housing currently used?">

<title>Mountain Doodles - Making Room</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/plain" cookie-consent="tracking">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-54516567-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Mountain Doodles - Making Room">
<meta property="og:description" content="How is low-density housing currently used?">
<meta property="og:image" content="https://doodles.mountainmath.ca/posts/2018-07-17-making-room/index_files/figure-html/empty_bedrooms-1.png">
<meta property="og:site_name" content="Mountain Doodles">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1728">
<meta name="twitter:title" content="Mountain Doodles - Making Room">
<meta name="twitter:description" content="How is low-density housing currently used?">
<meta name="twitter:image" content="https://doodles.mountainmath.ca/posts/2018-07-17-making-room/index_files/figure-html/empty_bedrooms-1.png">
<meta name="twitter:creator" content="@vb_jens">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1728">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../mm_stamp_small.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mountain Doodles</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> 
<span class="menu-text">Archive</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mountainMath/mountain_doodles"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link active" href="https://twitter.com/vb_jens" aria-current="page"> <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vb-jens/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jens.mountainmath.ca"> <i class="bi bi-envelope-at-fill" role="img" aria-label="Email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img" aria-label="RSS">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Making Room</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Making Room</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="https://github.com/mountainMath/mountain_doodles/blob/main/posts/2018-07-17-making-room/index.markdown"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          How is low-density housing currently used?
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">cancensus</div>
                <div class="quarto-category">CensusMapper</div>
                <div class="quarto-category">density</div>
                <div class="quarto-category">Vancouver</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jens von Bergmann </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 17, 2018</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<p><strong>Too much data, too little time</strong></p>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../profile.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/mountainMath" title="" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/vb_jens" title="" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://www.linkedin.com/in/vb-jens/" title="" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:jens.mountainmath.ca" title="" class="quarto-navigation-tool px-1" aria-label="Email"><i class="bi bi-envelope-at-fill"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Other Canadian data focused blogs:</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://homefreesociology.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HomeFreeSociology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.dshkol.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dmitry Shkolnik’s blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.simoncoulombe.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simon Coulombe’s blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://financesofthenation.ca/category/commentary/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finances of the Nation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://deny.substack.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deny’s Substack</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://higheredstrategy.com/author/alex/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alex Usher’s blog</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Mountain Doodles is an insomnia driven side project, born out of random questions, trying to give partial answers through data. During daytime at <a href="https://mountainmath.ca">MountainMath</a>.</p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Recently the City of Vancouver pivoted their planning for RS (“single family”) and RT (“duplex”) neighbourhoods from <a href="https://www.theglobeandmail.com/news/british-columbia/vancouver-drops-downzoning-plan-meant-to-curb-demolitions-of-character-houses/article34236732/">downzoning</a>, to slow the pace of teardowns to <a href="https://council.vancouver.ca/20170725/documents/p2.pdf">adding infill as an incentive to to keep older buildings through extensive renovations</a>, to now proposing the <a href="https://vancouver.ca/people-programs/making-room.aspx">Making Room</a> program to allow stratification and higher unit density, and <a href="https://www.theglobeandmail.com/canada/british-columbia/article-vancouver-mayor-gregor-robertson-pushes-to-allow-multiunit-housing-in/">Mayor Robertson adding an amendment</a> to direct staff to look into also allowing multiplexes.</p>
<p>This change in policy grew out of a <a href="https://vancouver.ca/people-programs/housing-vancouver-strategy-background.aspx">series of consultation processes</a>, and it is quite interesting to browse through them chronologically and observe the shift in how participants talk about low density zoning.</p>
<p>Change is hard, and public opinion is by no means uniform in their views. Making Room if facing fierce opposition in some quarters, all the while there are those, including myself, that are arguing it does not go far enough.</p>
<p>Today the first part of Making Room is <a href="https://council.vancouver.ca/20180717/phea20180717ag.htm">headed to council</a>. The changes associated with this are small, but have symbolic importance. The RS zoning documents start out with the sentence</p>
<blockquote class="blockquote">
<p>The intent of this Schedule is generally to maintain the single-family residential character of the RS-1 District</p>
</blockquote>
<p>and the goal is to change this “to better reflect the form of development in those districts”, i.e.&nbsp;that we already allow multiple dwelling units on all lots in Vancouver.</p>
<p>The second important change is to remove the mandate on “poor doors” in RS zoning. Right now, a “single family” home can only have one front door, the door to the secondary suite must not be visible from the street to maintain the “single family character”. This is partially symbolic, but it also paves the way to properly design for two dwelling units within the “single family” home, making secondary suites more livable.</p>
<p>More important changes are headed to council later this year, with more to come after the election.</p>
<p>We would like to take the opportunity of today’s council meeting to look at the data on how people currently live in low-density zoning.</p>
<section id="population-growth" class="level1">
<h1>Population growth</h1>
<p>The essence of Making Room is to allow more diverse housing types. Right now what’s legally allowed to be built in RS zones is a “single family home”, possibly with a suite and a laneway house. Suites can’t have front-facing doors in order to preserve the appearance of a “single family” neighbourhood, and the laneway house is restricted in size to about 700 square feet on regular sized lots. That means we allow a maximum of 3 units per lot, when we check our building stock we see we have on average a little less than half that. When it comes to suites we are close to equilibrium, with permit data indicating that we are building them at rates <a href="https://doodles.mountainmath.ca/blog/2018/05/23/teardowns-and-emissions/">only slightly above the freqency of suites in the overall stock</a>. We have been building around 400 laneway homes a year. Combined this has been <a href="https://doodles.mountainmath.ca/blog/2017/03/06/rs-population-change/">barely enough to keep population in RS zones stable</a>, with the east side of RS in Vancouver slightly gaining and the west side slightly draining population.</p>
<p>So when it comes to accommodating the population growth in the City, RS (and RT) are our deadbeat areas, whereas the multi-family areas pick up all the slack and accommodate the entire population growth. With RS, RT and FSD zones taking up 77% of residential land use, we are forcing all growth into the remaining 23% of residential land. Which forces us to build tall. And increasingly tear down smaller multi-family to make room for larger multi-family.</p>
<p>At the same time, we are <a href="https://doodles.mountainmath.ca/blog/2017/02/21/more-on-teardowns/">aggressively renewing our single-family building stock</a> without adding (significant) units, which leads to the City of Vancouver’s very ineffective construction process, where we tear down 1 unit for every 5 completed. And this does not only mean that we have to subtract one fifth of units from completion data if we want to talk about net new units, it also leads to <a href="https://doodles.mountainmath.ca/blog/2018/05/23/teardowns-and-emissions/">unneccessary carbon emissions</a> as we accommodate growth inefficiently.</p>
<p>Making Room asks low density zones to make room for our growing population by allowing new buildings to contain more units and accommodate more households. This helps improve the ratio of demolitions to completions and thus also reduce carbon emissions.</p>
</section>
<section id="complex-households" class="level1">
<h1>Complex households</h1>
<p>There is a lot of talk about the current “single family” building stock accommodating multi-generational households. Children might move out of their parent’s home, but some come back after forming their own families and live on their parent’s property. Either in a secondary suite or a laneway house, or sometimes switching roles with their parents depending on family needs. This can be mutually beneficial, and there is some variation across cultures in it’s prevalence.</p>
<p>Next to multi-generational households, we have more general multi-family households and other forms of <a href="https://doodles.mountainmath.ca/blog/2017/12/01/what-s-a-household/">“complex households”</a>, for example couple family (or lone parent) households (with or without children) with additional unrelated persons in the household. For the purpose of this section we want to focus on these “complex” households, while excluding roommate type households (two-or-more person non-census-family households).</p>
<p>Making Room asks to also allow other ways to split up homes and allow stratification and designing for multiple separate units. While current zoning allows for three units on a lot, it does not allow for three equal units.</p>
<p>An interesting question is how many “complex households” there are in “single family” homes, and how has this evolved over time.</p>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="864"></p>
<p>We see that 16% of households in both single detached, as well as suited single detached (“duplex”) units are “complex households”, which is a sizable share. Again, this includes multi-family households, as well as family households with unrelated persons. Is 16% high enough to justify mandating the current form of single ownership “single family” homes? Making Room would not disallow the use of homes as multi-family homes, and it would not disallow building new homes to fit that model. All it does allow to also build and design for other uses that would prefer to split up homes into smaller owenrship portions.</p>
</section>
<section id="geography-of-mutiple-census-family-households" class="level1">
<h1>Geography of mutiple-census-family households</h1>
<p>Looking at the geography of multiple-census-family households (skipping census family households with persons not in the census family that we aggregated into “complex households” above) can give us more information on where these households live.</p>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="864"></p>
<p>As expected, multi-family households are more prevalent in the “single-family” areas on the east and south side of Vancouver. We can derive further insight by looking at the change in the share of multi-family households over the past ten years.</p>
<p>Overall, the share of multi-family households decreased slightly from 2.82% of households in 2006 to 2.53% in 2016. We have seen that multi-family households cluster geographically, and we can check how the geographic distribution has changed over time.</p>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="864"></p>
<p>Surprisingly we see that the share of multi-family households generally declined on the east side and and increased on the west side. The change in share can be confounded by an increase in the number of households, we can also look at the change in number of multi-family households to get a different view on the change, greying out areas with fewer than 50 multi-family households in 2006.</p>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
<p>This only gives data on the east and south side areas, but it shows that increasing number of household has masked an actual increase in the number of multi-family households in some areas.</p>
</section>
<section id="empty-bedrooms" class="level1">
<h1>Empty bedrooms</h1>
<p>Vancouver has seen lots of discussions on empty homes. We read in the news how “unoccupied or under-utilized” homes should return to the market and be made available for purchase or long-term rental. Which is a good short-term initiative to increase the supply of available housing units, and at the same time ease worries about new buildings remaining empty. Here “under-utilized” refers to the the temporal nature, where for example a vacation home may only be occupied for a short period during the year. But homes can also be “under-utilized” if they have more bedrooms than the household requires. It is virtually impossible to ensure optimal utilization of homes, often considerable time passes after children move out and leave bedrooms empty until parents may (or may never) downsize. People purchase homes with additional bedrooms in anticipation of a growing family. Some people simply like and can afford to have extra bedrooms in their home in case of visitors or for other purposes.</p>
<p>But during a housing crisis, where we are comfortable to penalize units that are “under-utilized” temporally, we have to ask ourselves why we mandate “overhousing” through zoning that has the effect of forcing homes with more bedrooms than needed. Just to be clear, Making Room does not disallow overhousing, or restrict the number of bedrooms that could currently be built. But it allows homes to be subdivided (and stratified) into units that are right-sized.</p>
<p>To measure the degree of “overhousing” we can count “empty bedrooms”. For this we give each person in a household their own bedroom. We could go a bit further and assume couples share a bedroom <a href="https://censusmapper.ca/maps/966">like we have done in this interactive map</a>, but for this purpose we want to keep it simple. That means for example that we count a couple household with 1 kid to have no extra bedrooms if they live in a home with three or fewer bedrooms. We count studio apartments as 1 bedrooms here, and the other assumptions around large number of bedrooms or large household size are engineered to under-estimate the count of empty bedrooms. For details <a href="https://github.com/mountainMath/doodles/blob/master/content/posts/2018-07-17-making-room.Rmarkdown">check out the code</a>.</p>
<p>So how many empty bedrooms are there in low-density zoning? The census can’t quite answer than, but it can answer how many empty bedrooms there are in low-density housing units, the vast majority of which are situated in low-density zoning.</p>
<p><img src="index_files/figure-html/empty_bedrooms-1.png" width="864"></p>
<p>The result is really quite telling. Out of the 89,435 extra bedrooms, 60,505 of which are in “single family” homes. And this is not counting bedrooms in unoccupied or temporarily occupied homes (<a href="https://doodles.mountainmath.ca/blog/2018/01/25/empty-suites/">or suites</a>).</p>
<p>As an aside, we can also split the count of empty bedrooms by tenure. It should not surprise that renter households tend to be overhoused much less frequently with 3.16% of renter households having extra bedrooms versus 15.2% of Owner households across all structural types of dwellings.</p>
<p>Part of that is confounded by owner households being over-represented in “single family” homes, but even when just looking within single detached (so unsuited single family) homes we have 12.8% of renter households overhoused versus 25.6% of owner households.</p>
</section>
<section id="household-size" class="level1">
<h1>Household size</h1>
<p>A related dimension is that of household size. We can compare how the average household size has changed since 2006 by structural type of dwelling.</p>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="864"></p>
<p>This shows that both Single Detached and Duplex (a.k.a. suited single detached) units have seen a drop in household size, while household size has remained constant in the other dwelling types.</p>
<p>This shows that overhousing has been increasing in these dwelling types.</p>
</section>
<section id="children" class="level1">
<h1>Children</h1>
<p>“Single family” zoning emphasizes “family”, which in people’s minds usually means “family with children”. One question we can ask is what portion of people are children in each dwelling type.</p>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
<p>The results are quite surprising, at least to us. Row/Townhouse and Semi-detached (commonly referred to as “side-by-side duplex”) dwelling units have the highest share of children, followed by suited “single family” homes (“duplex”) and single detached homes. Unsurprisingly, the share of children is much lower in apartments, with low-rise registering with a higher share of children compared to taller apartments.</p>
<p>If accommodating families with children is one of the priorities, then Making Room is moving in exactly the right direction in that regard.</p>
</section>
<section id="affordability" class="level1">
<h1>Affordability</h1>
<p><a href="https://mountainmath.ca/affordability"><img src="images/sfh-affordability.png" style="width:50%;float:right;padding-left:10px;"></a> Ownership in low-density zones has been <a href="https://mountainmath.ca/map/values?filter=%5Bsfh_duplex,zone_RS_RT_FDS%5D">rapidly moving out of reach</a> for the majority of Vancouver families, which begs the question <a href="https://doodles.mountainmath.ca/blog/2017/09/18/zoned-for-who/">who is served by maintaining low-density zoning</a>.</p>
<p>Making Room proposes to allow stratification of housing units, which in principle gives the option of either buying the traditional “single family home” and renting out a suite, or stratifying the suite as a separate unit (assuming compliance with building codes) and only buying one of the two. Looking at how this <a href="https://doodles.mountainmath.ca/blog/2016/04/01/on-dirt-and-houses/">plays out in Mount Pleasant RT zones</a> where we have been allowing stratification and multi-plexes in connection with character retention and infill we see that this can substantially lower per-unit cost while only slightly inflating land values.</p>
<p>Making Room is bound to lower the bar of entry into low-density neighbourhoods. And reduce debt levels, the best mortgage helper is a lower mortgage (so stratifying the suite and selling it separately instead of taking on more debt and renting out the suite). But we are starting off from really high unafforadbility levels, moving to duplexes will make it still challenging to again be affordable to average families. Median incomes of City of Vancouver families with children <a href="https://censusmapper.ca/maps/838?index=13#9/49.2288/-123.0194">was $112k in 2015</a>. Building stock will take time to turn over and adapt to new regulation, most of the stratified duplexes coming out of this process will be new stock and thus more expensive. Moving beyond duplexes to multiplexes will further increase options and probably reach the majority of Vancouver families with children, we will have to do more analysis or wait for the staff report to quantify that.</p>
<p>So does Making Room go far enough to restore basic levels of inclusivity in Vancouver? I don’t think so. We have seen how low income residents <a href="https://doodles.mountainmath.ca/blog/2017/09/26/evolution-of-the-income-distribution/">have gotten pushed out of City of Vancouver proper</a>, with the top income brackets registering very strong growth. At a rate that’s noticeably higher than Metro or Canadian averages. Median incomes in the City of Vancouver used to lag the City of Toronto in 2005, <a href="https://doodles.mountainmath.ca/blog/2017/11/01/medians/">but in 2015 City of Vancouver came out on top of City of Toronto</a>. Inflation-adjusted average City of Vancouver home values have increased 89.1% 2006 to 2016, average inflation-adjusted ownership costs have increased 16.2% and average inflation-adjusted rent has increased 21.3%. At the same time, inflation-adjusted average family incomes have increased 16.3%.</p>
<p>This is reflected at the individual household level in that the share of shelter-cost-burdened households, those paying more than 30% of income on housing, has decreased 2006 to 2016. And this still holds true <a href="https://doodles.mountainmath.ca/blog/2017/10/26/a-first-look-at-vancouver-housing-data/">when running this separately for renter and owner households</a>.</p>
<p>So affordability actually increased using the CMHC 30% of income on shelter metric, due to strong income growth, self-selection in migration patterns by wealth and income, and tighter distributional matching of incomes to housing costs. The losers in the process are those without access to wealth, high income or both. It will take time to reverse some of this development. This will require a massive investment into public housing, as well as lowering the entry-point to market housing. Making Room works on that latter part, and ideally it can get expanded to higher density of maybe 6 units per lot to reach further down the income distribution. At the same time we need to find ways to address the lower ends of the income distribution that the Vancouver market simply won’t be able to serve, even if the market corrects somewhat.</p>
<p>The city has been working of subsidized rental models via inclusionary zoning, and providing land for alternative ownership models. The province and the federal government are starting to take their role in the public housing sector more seriously. But it will take more than what is currently being offered to undo the results of decade-long inaction on the public housing front.</p>
</section>
<section id="upshot" class="level1">
<h1>Upshot</h1>
<p>The data of how low-density housing is getting used points toward the Making Room initiative going in the right direction. There are many factors contributing to Vancouver’s affordability problem, the abundance of low density zoning close to the centre of our metropolitan area is an important one. Many Vancouverites look with envy toward Vienna for their affordable housing, but often neglect that, among other important differences, <a href="https://doodles.mountainmath.ca/blog/2017/09/08/the-vienna-model/">Vienna does not have low density areas so close to the city centre like Vancouver does</a>.</p>
<p>As usual, the code that made this post is <a href="https://github.com/mountainMath/doodles/blob/master/content/posts/2018-07-17-making-room.Rmarkdown">available on GitHub</a>, including for gathering the required data, generating the graphs and all numbers quoted in the text. Feel free to download it to reproduce or adapt for your purposes.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{von bergmann2018,
  author = {von Bergmann, Jens},
  title = {Making {Room}},
  date = {2018-07-17},
  url = {https://doodles.mountainmath.ca/posts/2018-07-17-making-room},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-von bergmann2018" class="csl-entry quarto-appendix-citeas" role="listitem">
Bergmann, Jens von. 2018. <span>“Making Room.”</span>
<em>MountanDoodles</em> (blog). July 17, 2018. <a href="https://doodles.mountainmath.ca/posts/2018-07-17-making-room">https://doodles.mountainmath.ca/posts/2018-07-17-making-room</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/doodles\.mountainmath\.ca");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="mountainmath/mountain_doodles" data-repo-id="R_kgDOLuoDtA" data-category="Blog posts" data-category-id="DIC_kwDOLuoDtM4Cetfc" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark_dimmed">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>