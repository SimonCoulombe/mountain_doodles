<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jens von Bergmann">
<meta name="author" content="Nathan Lauster">
<meta name="dcterms.date" content="2021-10-03">
<meta name="description" content="Paving the way for removing minimum parking requirements.">

<title>Mountain Doodles - Fixing parking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/plain" cookie-consent="tracking">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-54516567-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Mountain Doodles - Fixing parking">
<meta property="og:description" content="Paving the way for removing minimum parking requirements.">
<meta property="og:image" content="https://doodletest.netlify.app/posts/2021-10-03-fixing-parking/index_files/figure-html/existing-parking-permit-zones-1.png">
<meta property="og:site_name" content="Mountain Doodles">
<meta property="og:image:height" content="1800">
<meta property="og:image:width" content="2400">
<meta name="twitter:title" content="Mountain Doodles - Fixing parking">
<meta name="twitter:description" content="Paving the way for removing minimum parking requirements.">
<meta name="twitter:image" content="https://doodletest.netlify.app/posts/2021-10-03-fixing-parking/index_files/figure-html/existing-parking-permit-zones-1.png">
<meta name="twitter:creator" content="@vb_jens">
<meta name="twitter:image-height" content="1800">
<meta name="twitter:image-width" content="2400">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../mm_stamp_small.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mountain Doodles</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> 
<span class="menu-text">Archive</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mountainMath/mountain_doodles"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link active" href="https://twitter.com/vb_jens" aria-current="page"> <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vb-jens/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jens.mountainmath.ca"> <i class="bi bi-envelope-at-fill" role="img" aria-label="Email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img" aria-label="RSS">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Fixing parking</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Fixing parking</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source" data-quarto-source-url="https://github.com/mountainMath/mountain_doodles/blob/main/posts/2021-10-03-fixing-parking/index.markdown"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          Paving the way for removing minimum parking requirements.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Vancouver</div>
                <div class="quarto-category">taxes</div>
                <div class="quarto-category">Transportation</div>
                <div class="quarto-category">zoning</div>
                <div class="quarto-category">cancensus</div>
                <div class="quarto-category">CensusMapper</div>
                <div class="quarto-category">affordability</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Jens von Bergmann </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              MountainMath
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Nathan Lauster </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              UBC, Department of Sociology
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 3, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<p><strong>Too much data, too little time</strong></p>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../profile.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/mountainMath" title="" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/vb_jens" title="" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://www.linkedin.com/in/vb-jens/" title="" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:jens.mountainmath.ca" title="" class="quarto-navigation-tool px-1" aria-label="Email"><i class="bi bi-envelope-at-fill"></i></a>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Other Canadian data focused blogs:</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://homefreesociology.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HomeFreeSociology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.dshkol.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dmitry Shkolnik’s blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.simoncoulombe.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simon Coulombe’s blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://financesofthenation.ca/category/commentary/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finances of the Nation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://deny.substack.com" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deny’s Substack</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://higheredstrategy.com/author/alex/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alex Usher’s blog</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Mountain Doodles is an insomnia driven side project, born out of random questions, trying to give partial answers through data. During daytime at <a href="https://mountainmath.ca">MountainMath</a>.</p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p style="text-align:center;">
<i>(Joint with Nathan Lauster and cross-posted at <a href="https://homefreesociology.com/2021/10/04/fixing-parking/" target="_blank">HomeFreeSociology</a>)</i>
</p>
<p>New parking proposal just dropped! As Vancouver City Council once again discusses parking it seems like a good time to give a brief overview of the trade-offs involved, with special focus on the progressivity of parking permit fees. Vancouver proposed to introduce a <a href="https://shapeyourcity.ca/parking?tool=news_feed#tool_tab">city-wide parking permit program</a>, requiring residents to buy a $45/year parking permit to park their vehicles on city streets (reduced to $5 for people with low incomes), or pay a $3 overnight visitor parking fee. Additionally the City proposes higher annual fees of $500 to $1000 for new gasoline-powered cars built 2023 or later.</p>
<p>The <a href="https://council.vancouver.ca/20211005/documents/spec5.pdf?_ga=2.245035654.2037365503.1633069829-765582701.1632454577">motion</a> reads:</p>
<blockquote class="blockquote">
<p>The program consists of a pollution charge of up to $1,000 to be added to parking permit fees for more polluting vehicles 2023 or newer, as well as a $45 overnight parking permit for residential streets in the City that are currently unregulated, which would be reduced to $5 for people with low incomes.</p>
</blockquote>
<p>To emphasize the key point the program has two components:</p>
<ul>
<li>A pollution charge for polluting vehicles 2023 or newer.</li>
<li>A city-wide overnight parking permit for residentials streets of $45 (reduced to $5 for people with low incomes).</li>
</ul>
<p>In this post we will mostly concern ourselves with the second component, this gets at the fundamental problem of privileging land use for vehicle storage above other uses and lays the groundwork for removing minimum parking requirements as explained in the motion:</p>
<blockquote class="blockquote">
<p>An analysis of the feasibility and implications of removing the City’s regulatory minimum parking requirements for new developments will be brought back to Council at a later date.</p>
</blockquote>
<section id="parking-101" class="level2">
<h2 class="anchored" data-anchor-id="parking-101">Parking 101</h2>
<p>To understand why this is being proposed let’s take a step back and take a careful look at parking. Don Shoup explains in his book <a href="https://www.amazon.ca/High-Cost-Free-Parking-Updated/dp/193236496X">The High Cost of Free Parking</a></p>
<blockquote class="blockquote">
<p>Every transport system has three elements: vehicles, rights of way, and terminal capacity. Rail transport, for example, has trains, tracks and stations. Sea transport has ships, oceans and seaports, Air transport has planes, the sky and airports. Automobile transport has cars, roads and parking spaces. Two aspects of its terminal capacity set automobile transport apart from all other transport systems. First, automobile transport requires enormous terminal capacity - it is land-hungry - because there are so many cars and several parking spaces for each one. Second, motorists park free for 99 percent of their trips because off-street parking requirements remove the cost of automobile terminal capacity from the transport sector and shifts it everywhere else in the economy.</p>
</blockquote>
<p><img src="images/car-tent.jpg" style="float:right;width:50%;margin-left:10px;">This hints at while it is so expensive to find land for people to live in Vancouver, it is free to find land for cars to park. This is how we designed it. We have strong restrictions on building space for people to live, and at the same time strong requirements to provide space for cars to park. This also links into the <a href="https://open.library.ubc.ca/cIRcle/collections/ubctheses/24/items/1.0397221">growing phenomenon of people living in their vehicles in Vancouver</a>.</p>
<p>In the <a href="http://shoup.bol.ucla.edu/TrafficTechnologyInterview.pdf">words of Don Shoup</a>:</p>
<blockquote class="blockquote">
<p>We have free parking for cars and expensive housing for people. We’ve got our priorities the wrong way around!</p>
</blockquote>
<p>For example, the City of Vancouver requires one off-street parking space for every 28 gross square metres of space used as a detoxification centre, but one for every 9.3 square metres of space used as a bingo hall, only counting the area of the actual hall. A curling rink needs to supply three off-street parking spaces for every ice sheet, two spaces are needed for every racquet court. A one-family dwelling with suite and laneway house needs at least one off-street parking space, but a side-by-side duplex with one secondary suite needs three off-street parking spaces even though it has the same number of dwelling units.</p>
<p>If this sounds ludicrous and like pseudo-science, then that’s because it is. But why do we have minimum parking requirements like this in the first place? Does a curling rink in the West End really need to provide the same number of parking spaces as (a hypothetical) one in Southlands? What’s wrong with letting people decide how much off-street parking space they need? If a family wants to go car-free, that should be encouraged. But in Vancouver a family can’t buy a condo without a parking space. We are forcing car-free families to pay extra for something they don’t need. How much extra? It costs about $200 to $250 per month to finance and maintain an underground parking stall. That’s a lot of extra cost for something a family does not need.</p>
<p>Wait, an off-street parking space costs $200 per month? Who pays for that you might ask. The answer is: Everyone. That’s because the cost of off-street parking is bundled with other services.</p>
</section>
<section id="parking-is-bundled" class="level2">
<h2 class="anchored" data-anchor-id="parking-is-bundled">Parking is bundled</h2>
<p>Because we require so much parking, parking is over-supplied. And we can’t charge the true price for the cost of parking. But someone has to pay for it, and we do this by bundling parking with other services.</p>
<p>When you buy a condo, it comes with a parking space and the price of parking becomes part of the price for the home. Maybe you have the option of buying an extra space, or not buying any parking, but the cost or savings for that rarely amount to the ~$50,000 that it costs to build, finance and maintain that space. Part of that space is cross-subsidized with the cost of your living space.</p>
<p>Similarly, when you are renting there may be a an extra charge for a parking space. But that charge will typically run around $60 and not the $200 to $250 it actually costs. Who pays the rest? You pay for that through your rent. And if you choose not to rent a parking space, and your neighbour gets a second car and buys that extra space for $60, you are still cross-subsidizing your neighbour’s second car parking spot to the tune of ~$150/month through your rent.</p>
<p>When you go shopping you often don’t pay for parking. But the store is (hopefully) not losing money, they pay for it through higher prices on the groceries you are buying. You walked to the store to get groceries? You still pay for someone else’s parking spot.</p>
<p>We make driving artificially cheap and cross-subsidize that by making housing and shopping more expensive. You think that’s messed up? Yup, that’s messed up. But that’s how we roll. As Don Shoup famously noted in his <a href="https://journals.sagepub.com/doi/10.1177/0739456X9701700102">influential article “The High Cost of Free Parking”</a>:</p>
<blockquote class="blockquote">
<p>Minimum parking requirements act like a fertility drug for cars. Why do urban planners prescribe this drug?</p>
</blockquote>
<p>This is crazy, and it needs to change. We need to get rid of off-street parking requirements and let people decide if they want parking with their housing or if they don’t. But there is a catch. As long as on-street parking is free or cheap, people will simply store their vehicles on the street if we stop requiring off-street parking. In fact, the whole reason we have these off-street parking requirements in the first place is to keep street parking free.</p>
<p>Historically, as cars arrived in cities, they started to clog up space when parked. There were essentially two ways people solved this problem of streets clogged by parked cars. Some places, like North America, solved this by requiring ample off-street parking, so on-street parking would not be scarce. Others, like Tokyo, solved this by requiring people wanting to register their car to prove that they had an off-street parking space. In North America everyone pays for the cost of parking, whether they use that parking or not. In Tokyo, only drivers pay for their off-street parking spot.</p>
</section>
<section id="the-need-to-manage-on-street-parking" class="level2">
<h2 class="anchored" data-anchor-id="the-need-to-manage-on-street-parking">The need to manage on-street parking</h2>
<p>This brings us back to the city proposal. If we want to rectify the ridiculous situation where we force people to pay upward of $200 a month for parking they don’t use, we need to tackle the problem of congested on-street parking. And there is an effective solution to this tragedy of the commons: Charge the lowest price so that about 20% of spaces are available for people to park. This means that the resource of street parking is well-utilized while anyone who wants to park can find parking. Vancouver already does exactly this along commercial areas, where parking fees are performance-based. Parking utilization gets monitored, and when utilization goes down the city drops the prices. If utilization goes up, the city raises them.</p>
<p>The new city proposal expands this to residential parking. It establishes a (nominal) baseline fee of $45 per year for a parking permit, with the possibility of raising these fees if parking becomes scarce. We have already seen something like this in the West End, where the city has introduced significantly higher parking fees for new vehicle registrations while grandfathering in old registrations at a lower rate that also applies to low-income households.</p>
<p>A system to manage on-street parking is a necessary step in order to drop or significantly lower off-street parking requirements.</p>
</section>
<section id="existing-parking-permit-districts" class="level2">
<h2 class="anchored" data-anchor-id="existing-parking-permit-districts">Existing parking permit districts</h2>
<p>Some areas of the city are already covered by permit parking zones, so they won’t be affected by the rule change. Other areas, like Yaletown or Coal Harbour, are essentially covered by metered parking, or don’t allow parking at all.</p>
<p><img src="index_files/figure-html/existing-parking-permit-zones-1.png" width="1200"></p>
<p>While the parking meter data we have gives only approximate coverage of the metered areas and does not contain information on parking restricted portions, it is worthwhile to estimate characteristics of the population already covered by paid permit parking. In those areas 20% of the population is in low income (LIM-AT) compared to 19% in the City overall, and 70% of households are renting compared to 53%. In total 33% of City of Vancouver renter households live in existing paid parking permit areas.</p>
<p>Additionally the city has residential only parking districts that don’t require permits and don’t require paying a fee. They operate on a snitch basis, where residents can park on their block and enforcement is only on a complaint basis, where residents call in when they observe non-residents parking on their block.</p>
<p><img src="index_files/figure-html/snitch-parking-zones-1.png" width="1200"></p>
<p>These are zones where residents have managed to secure exclusive access to public street parking without having to pay for it. Unsurprisingly, low income people at 16% of the population and renters at 43% are under-represented in these areas.</p>
<p>The new proposal would expand paid parking for overnight parking from the current permit parking zones to the rest of the city, including the no-permit snitch-enforced residential parking only areas.</p>
</section>
<section id="equity" class="level2">
<h2 class="anchored" data-anchor-id="equity">Equity</h2>
<p>Don Shoup observed in his book that</p>
<blockquote class="blockquote">
<p>[parking requirements] increase traffic congestion and air pollution, distort urban form, degrade urban design, increase housing costs, limit homeownership, damage the urban economy, harm the central business district, and penalize poor families.</p>
</blockquote>
<p>Yet just like clockwork, whenever a policy change gets proposed that might inconvenience upper middle class people, like increasing property taxes - or in this case charging for parking - the ample evidence concerning how the existing policies hurt poor people gets ignored and wealthy people explain: “But this will hurt low-income people!”</p>
<p>While many planners have changed their view on parking and are pushing for change, it should not be surprising that some of the most outspoken critics of change are also planners, who after all created and upheld the perverse minimum parking requirements that privilege cars and car ownership and disproportionately hurt low-income people. And the proposed $45 per year ($5 for low income people) pales in comparison to the ~$200/month planners have imposed on car-free low income people in this city.</p>
<p>For example one local commentator noted correctly that <a href="https://vancouversun.com/news/ability-to-shift-car-use-after-new-parking-proposals-could-differ-across-vancouver-expert">“18 per cent of workers who are living in Vancouver have starting or ending commute times that might not fit into the transit schedule because they start between midnight and 6 a.m.”</a> where “the start times don’t match transit schedules”, but conveniently failed to mention that those living in the City of Vancouver and commuting to work between midnight and 6am are <a href="https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/dt-td/Rp-eng.cfm?LANG=E&amp;APATH=7&amp;DETAIL=0&amp;DIM=0&amp;FL=M&amp;FREE=0&amp;GC=0&amp;GID=0&amp;GK=0&amp;GRP=1&amp;PID=111334&amp;PRID=10&amp;PTYPE=109445&amp;S=0&amp;SHOWALL=0&amp;SUB=0&amp;Temporal=2016,2017&amp;THEME=0&amp;VID=0&amp;VNAMEE=Main%20mode%20of%20commuting%20%2810%29&amp;VNAMEF=Principal%20mode%20de%20transport%20pour%20la%20navette%20%2810%29">more likely to to take transit and less likely to drive to work than people commuting to work at other times</a>.</p>
<p><img src="index_files/figure-html/cov_time_leaving_for_work_mode-1.png" width="1200"></p>
<p>Others make vague <a href="https://thetyee.ca/News/2021/06/28/Drive-Towards-Sustainable-City-Motorists-Left-Behind/">arguments about which neighbourhoods get impacted by parking fees</a>, citing neighbourhood level aggregate stats without ever attempting to understand how this relates to individuals. Claims like <a href="https://thetyee.ca/News/2021/06/28/Drive-Towards-Sustainable-City-Motorists-Left-Behind/">half of commuters driving or being driven to work […] in areas with rapid-transit stations (with the exception of Downtown and Strathcona)</a> are also not helpful. Examining mode share to work from the 2016 Census in the 10 minute walk sheds around skytrain stations show that this is selling several stations short.</p>
<p><img src="index_files/figure-html/skytrain-stations-mode-1.png" width="1200"></p>
<p>There are however stations with catchment areas still showing a high share of car commuters, which incidentally coincide with the stations where low-density land use and elevated share of owner households remain.</p>
<p><img src="index_files/figure-html/skytrain-stations-tenure-1.png" width="1200"></p>
<p>Additionally, much of the catchment areas of stations around regions with higher density land use are already covered by existing permit parking zones.</p>
<p>We can also explore fine-area ecological correlations between mode share, incomes and tenure using our <a href="https://censusmapper.ca/maps/983#12/49.2528/-123.1046">CensusMapper map from 2017</a>. While ecological correlations are known to be misleading at times, at fine levels of analysis they can provide insight into geographic variation. And they reflect the same trends. Lower income commuters are less likely to drive to work.</p>
<p><a href="https://censusmapper.ca/maps/983#12/49.2528/-123.1046"><img src="images/mode_share_tenure_income.png" class="img-fluid"></a></p>
<p>What all this tells us is what we pretty much knew already. Higher income people drive more than lower income people, owners drive more than renters, and our current setup of bundling parking disproportionately hits lower income people and renters. That’s the real equity issue here. Worth remembering as well that the big fees being charged apply only to new gas-guzzling vehicles which lower income people are least likely able to afford!</p>
<p>That is not to say that all equity concerns are unfounded. There are some real equity concerns that come with almost any policy change, and parking is no different. There are winners and losers, and some of the losers are lower income people. Moreover, charging for parking only works if people have alternatives to fall back on. The City of Vancouver is in a fortunate position of having almost universal frequent transit coverage, and it is relatively easy to expand this to the few missing places. Still, the level of service varies considerably throughout the frequent transit network.</p>
<p>But for some people this may not be a viable alternative even when they live close to transit. Disabled people come to mind, and switching from driving to other modes of transport might be unduly burdensome for them. That’s why the City of Vancouver proposal exempts vehicles equipped to transport wheelchairs. More broadly, the city has amended their initial proposal to charge everyone else $45/month to park overnight to lower this to $5 for people in low income, similar to analogous exemptions already in place for the West End parking plan. There is definitely work to be done around the edges of changing the rules for parking, and the City appears to have done just that.</p>
</section>
<section id="the-bigger-equity-picture" class="level2">
<h2 class="anchored" data-anchor-id="the-bigger-equity-picture">The bigger equity picture</h2>
<p>But is it really just work that needs to be done around the edges, or is something like charging for parking regressive on average? In that case, tinkering at the edges won’t be enough. Who benefits from the status quo and who doesn’t? Does Don Shoup’s statement that parking requirements “penalize poor families” hold in today’s Vancouver? Let’s take a look at Vancouver data.</p>
<p>To understand equity issues we are interested in the relationship of driving and car reliance to income and other socio-economic factors at the individual level, understanding this question needs cross tabulations at the individual person or household/family level.</p>
<p>Census data can inform on this, and while we don’t have a city level cross tabulation on income and commute mode to work available we can check the Metro Vancouver level relationships using PUMF data.</p>
<p><img src="index_files/figure-html/yvr_mode_lico-1.png" width="1200"></p>
<p>The results are of course not surprising, drivers have the lowest share of low-income commuters. After all, owning and operating a car is expensive! This means the status quo hits low-income commuters the hardest as they disproportionately pay for car parking they don’t tend to use as much, be at their home, shopping, or in many cases also at work where parking continues to be subsidized.</p>
<p>But are these Metro level relationships still valid at the City level? And what about trips other than going to work, or more generally, just owning a car?</p>
<p>The <a href="https://vancouver.ca/files/cov/2019-transportation-panel-survey.pdf">2019 City of Vancouver Transportation Panel Survey</a> has information on incomes and car ownership and usage. We can confidently note that higher income people are more likely to have access to private motor vehicles.</p>
<p><img src="images/cov_transportation_panel_2.png" class="img-fluid"> Similarly, higher income people are more likely to use private motor vehicles for trips (not just counting trips to work).</p>
<p><img src="images/cov_transportation_panel_1.png" class="img-fluid"></p>
<p>This shows quite clearly that low income people have been particularly hurt by our massive planning failure of making parking cheap and socializing the cost of parking into housing and the price of goods and services. And to add insult to injury, low income people are also most impacted by the induced car dependence as well as downstream effects on climate.</p>
<p>But these are average effects, and even if we undo minimum parking requirements today it will take time to unlock the benefits of reversing almost a century of planning malpractice. This tells us we should pay more attention to the individual level short-term changes, and ask how to structure the transition in a way that minimizes stress on low-income populations.</p>
</section>
<section id="upshot" class="level2">
<h2 class="anchored" data-anchor-id="upshot">Upshot</h2>
<p>What have we learned from all of this? The City of Vancouver is no outlier in how existing parking regulations adversely impact low-income populations. This proposal, putting in place a mechanism to charge for on-street parking city-wide, is a necessary step in reversing one of the most profound planning failures: minimum parking requirements.</p>
<p>Yet change is hard and affects different people differently, and it will take time until citizens can reap the benefits of removing minimum parking requirements. To ease the transition the proposal significantly lowers the fee for low-income people, from $45 to $5. Down the road prices for street parking permits may increase depending on demand, just like we have already seen in the West End. Grandparenting and discounts for low-income populations - as in the West End - can ease that transition.</p>
<p>If planners had paid as much attention to affordable housing as we have to affordable parking, Vancouver would be a very different city. It is good to see that city planners are realizing this and are taking steps to adjust their priorities. The benefits of this won’t materialize overnight, but this city-wide permit parking proposal is an important and necessary step along the way.</p>
<p>As usual, the code for this post is <a href="https://github.com/mountainMath/doodles/blob/master/content/posts/2021-10-03-fixing-parking/index.Rmarkdown">available on GitHub</a> for anyone to reproduce or adapt.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{von bergmann2021,
  author = {von Bergmann, Jens and Lauster, Nathan},
  title = {Fixing Parking},
  date = {2021-10-03},
  url = {https://doodletest.netlify.app/posts/2021-10-03-fixing-parking},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-von bergmann2021" class="csl-entry quarto-appendix-citeas" role="listitem">
Bergmann, Jens von, and Nathan Lauster. 2021. <span>“Fixing
Parking.”</span> <em>MountanDoodles</em> (blog). October 3, 2021. <a href="https://doodletest.netlify.app/posts/2021-10-03-fixing-parking">https://doodletest.netlify.app/posts/2021-10-03-fixing-parking</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/doodletest\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="mountainmath/mountain_doodles" data-repo-id="R_kgDOLuoDtA" data-category="Blog posts" data-category-id="DIC_kwDOLuoDtM4Cetfc" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark_dimmed">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>